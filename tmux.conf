# Claude Code SSH â€” tmux configuration
# Optimized for mobile SSH clients (Termius, Blink, JuiceSSH) over network

# ---------- Terminal & Color Support ------------------------------------------
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# ---------- Escape Sequence Handling ------------------------------------------
# CRITICAL: Must be 500+ for SSH connections to prevent Device Attributes
# response leak ("0;95;0c" characters). tmux queries terminal capabilities
# via escape sequences; over SSH the response arrives with latency and gets
# misinterpreted as keyboard input if escape-time is too low.
# See: https://github.com/tmux/tmux/pull/4411
set -sg escape-time 500

# Enable xterm-style function key sequences (Shift+Arrow, Ctrl+Arrow, etc.)
set -g xterm-keys on

# ---------- Mouse Support (essential for mobile touch) ------------------------
set -g mouse on

# ---------- Scrollback --------------------------------------------------------
set -g history-limit 50000

# ---------- Window & Pane Management ------------------------------------------
# Start numbering at 1 (easier on mobile keyboards)
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Aggressively resize to the smallest *currently attached* client
setw -g aggressive-resize on

# ---------- Session Persistence -----------------------------------------------
# Keep sessions alive when SSH disconnects (mobile connection drops)
set -g destroy-unattached off

# ---------- Environment -------------------------------------------------------
# Propagate key variables when reattaching
set -g update-environment "SSH_AUTH_SOCK SSH_CONNECTION DISPLAY ANTHROPIC_API_KEY"
